(function(e,t){var n=0;e.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var t=this,n=this.element[0].ownerDocument,r;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(n){if(t.options.disabled||t.element.propAttr("readOnly")){return}r=false;var i=e.ui.keyCode;switch(n.keyCode){case i.PAGE_UP:t._move("previousPage",n);break;case i.PAGE_DOWN:t._move("nextPage",n);break;case i.UP:t._keyEvent("previous",n);break;case i.DOWN:t._keyEvent("next",n);break;case i.ENTER:case i.NUMPAD_ENTER:if(t.menu.active){r=true;n.preventDefault()};case i.TAB:if(!t.menu.active){return}t.menu.select(n);break;case i.ESCAPE:t.element.val(t.term);t.close(n);break;default:clearTimeout(t.searching);t.searching=setTimeout(function(){if(t.term!=t.element.val()){t.selectedItem=null;t.search(null,n)}},t.options.delay);break}}).bind("keypress.autocomplete",function(e){if(r){r=false;e.preventDefault()}}).bind("focus.autocomplete",function(){if(t.options.disabled){return}t.selectedItem=null;t.previous=t.element.val()}).bind("blur.autocomplete",function(e){if(t.options.disabled){return}clearTimeout(t.searching);t.closing=setTimeout(function(){t.close(e);t._change(e)},150)});this._initSource();this.menu=e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo||"body",n)[0]).mousedown(function(n){var r=t.menu.element[0];if(!e(n.target).closest(".ui-menu-item").length){setTimeout(function(){e(document).one("mousedown",function(n){if(n.target!==t.element[0]&&n.target!==r&&!e.ui.contains(r,n.target)){t.close()}})},1)}setTimeout(function(){clearTimeout(t.closing)},13)}).menu({focus:function(e,n){var r=n.item.data("item.autocomplete");if(false!==t._trigger("focus",e,{item:r})){if(/^key/.test(e.originalEvent.type)){t.element.val(r.value)}}},selected:function(e,r){var i=r.item.data("item.autocomplete"),s=t.previous;if(t.element[0]!==n.activeElement){t.element.focus();t.previous=s;setTimeout(function(){t.previous=s;t.selectedItem=i},1)}if(false!==t._trigger("select",e,{item:i})){t.element.val(i.value)}t.term=t.element.val();t.close(e);t.selectedItem=i},blur:function(e,n){if(t.menu.element.is(":visible")&&t.element.val()!==t.term){t.element.val(t.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if(e.fn.bgiframe){this.menu.element.bgiframe()}t.beforeunloadHandler=function(){t.element.removeAttr("autocomplete")};e(window).bind("beforeunload",t.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();e(window).unbind("beforeunload",this.beforeunloadHandler);e.Widget.prototype.destroy.call(this)},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments);if(t==="source"){this._initSource()}if(t==="appendTo"){this.menu.element.appendTo(e(n||"body",this.element[0].ownerDocument)[0])}if(t==="disabled"&&n&&this.xhr){this.xhr.abort()}},_initSource:function(){var t=this,n,r;if(e.isArray(this.options.source)){n=this.options.source;this.source=function(t,r){r(e.ui.autocomplete.filter(n,t.term))}}else if(typeof this.options.source==="string"){r=this.options.source;this.source=function(n,i){if(t.xhr){t.xhr.abort()}t.xhr=e.ajax({url:r,data:n,dataType:"json",success:function(e,t){i(e)},error:function(){i([])}})}}else{this.source=this.options.source}},search:function(e,t){e=e!=null?e:this.element.val();this.term=this.element.val();if(e.length<this.options.minLength){return this.close(t)}clearTimeout(this.closing);if(this._trigger("search",t)===false){return}return this._search(e)},_search:function(e){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(r){if(t===n){e.__response(r)}e.pending--;if(!e.pending){e.element.removeClass("ui-autocomplete-loading")}}},__response:function(e){if(!this.options.disabled&&e&&e.length){e=this._normalize(e);this._suggest(e);this._trigger("open")}else{this.close()}},close:function(e){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",e)}},_change:function(e){if(this.previous!==this.element.val()){this._trigger("change",e,{item:this.selectedItem})}},_normalize:function(t){if(t.length&&t[0].label&&t[0].value){return t}return e.map(t,function(t){if(typeof t==="string"){return{label:t,value:t}}return e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t);this.menu.deactivate();this.menu.refresh();n.show();this._resizeMenu();n.position(e.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new e.Event("mouseover"))}},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItem(t,n)})},_renderItem:function(t,n){return e("<li></li>").data("item.autocomplete",n).append(e("<a></a>").text(n.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)){this.element.val(this.term);this.menu.deactivate();return}this.menu[e](t)},widget:function(){return this.menu.element},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(e,t);t.preventDefault()}}});e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}})})(jQuery);(function(e){e.widget("ui.menu",{_create:function(){var t=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(n){if(!e(n.target).closest(".ui-menu-item a").length){return}n.preventDefault();t.select(n)});this.refresh()},refresh:function(){var t=this;var n=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");n.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(n){t.activate(n,e(this).parent())}).mouseleave(function(){t.deactivate()})},activate:function(e,t){this.deactivate();if(this.hasScroll()){var n=t.offset().top-this.element.offset().top,r=this.element.scrollTop(),i=this.element.height();if(n<0){this.element.scrollTop(r+n)}else if(n>=i){this.element.scrollTop(r+n-i+t.height())}}this.active=t.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:t})},deactivate:function(){if(!this.active){return}this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,t,n){if(!this.active){this.activate(n,this.element.children(t));return}var r=this.active[e+"All"](".ui-menu-item").eq(0);if(r.length){this.activate(n,r)}else{this.activate(n,this.element.children(t))}},nextPage:function(t){if(this.hasScroll()){if(!this.active||this.last()){this.activate(t,this.element.children(".ui-menu-item:first"));return}var n=this.active.offset().top,r=this.element.height(),i=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-n-r+e(this).height();return t<10&&t>-10});if(!i.length){i=this.element.children(".ui-menu-item:last")}this.activate(t,i)}else{this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(t){if(this.hasScroll()){if(!this.active||this.first()){this.activate(t,this.element.children(".ui-menu-item:last"));return}var n=this.active.offset().top,r=this.element.height(),i=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-n+r-e(this).height();return t<10&&t>-10});if(!i.length){i=this.element.children(".ui-menu-item:first")}this.activate(t,i)}else{this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[e.fn.prop?"prop":"attr"]("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})})(jQuery)